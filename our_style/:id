<!-- GALLERY MODAL -->
<div class="custom-modal-backdrop"></div>
<div class="custom_modal">
    <span class="modal_close"><i class="fa fa-times" aria-hidden="true"></i></span>
    <a class="open_details_modal" id="prev" data-modal-id="id">
        <i class="fa fa-chevron-left prev_arrow" aria-hidden="true"></i>
    </a>
    <a class="open_details_modal" id="next" data-modal-id="id">
        <i class="fa fa-chevron-right next_arrow" aria-hidden="true"></i>
    </a>
    <div class="modal_50">
        <img class="modal_img" src="http://placehold.it/337x337" />
    </div>
    <div class="modal_50">
        <h4 id="modal_name">Heading</h4>
        <p id ="modal_desc">desc</p>
        <div class="sharer_icons">
            <p class="pull-left">Share This Post:</p>
            <a id="share_fb" target="_blank" href="#">
                <img class="modal_share_icon pull-left" src="//codecloud.cdn.speedyrails.net/sites/5808c7e76e6f6414b30c0000/image/jpeg/1490794350000/fb.jpg" alt="Facebook Logo">
            </a>
            <a id="share_twitter" target="_blank" href="#">
                <img class="modal_share_icon pull-left" src="//codecloud.cdn.speedyrails.net/sites/5808c7e76e6f6414b30c0000/image/jpeg/1490794359000/tw.jpg" alt="Twitter Logo">
            </a>
        </div>
    </div>
    <div class="clearfix"></div>
</div>
<!-- -->
<div class="jobs_banner text-center">
    <h3>BLOG</h3>
    <p>explore • enjoy • shop</p>
</div>
<div class="store_list_head main_container">
    <div class="row">
        <div class="col-md-6">
            <h5 class="pull-left"><a href="/our_style"><img src="//codecloud.cdn.speedyrails.net/sites/5808c7e76e6f6414b30c0000/image/png/1490621978000/left.png" class="post_details_arrow" alt=""> Back to Our Style</a></h5>
        </div>
    </div>
</div>
<div class="margin_20"></div>
<div class="content_container main_container mobile_padding">
    <div id="post_details_container">
        <script id="post_details_template" type="x-tmpl-mustache/text">
            <div class="row_fluid">
                <div class="post_details_image">
                    <img src="{{post_image}}" alt="{{title}}" />
                </div>
                <div class="details_share_icons hidden_phone">
                    <a href="http://www.facebook.com/sharer.php?u=http://www.halifaxshoppingcentre.com/our_style/{{slug}}" target="_blank">
                        <img class="details_icon" src="//codecloud.cdn.speedyrails.net/sites/5808c7e76e6f6414b30c0000/image/jpeg/1490794350000/fb.jpg" alt="Facebook Logo">
                    </a>
                    <a href="http://twitter.com/home?status={{twitter_title}} http://www.halifaxshoppingcentre.com/our_style/{{slug}}" target="_blank">
                        <img class="details_icon" src="//codecloud.cdn.speedyrails.net/sites/5808c7e76e6f6414b30c0000/image/jpeg/1490794359000/tw.jpg" alt="Twitter Logo">
                    </a>
                </div>
            </div>
            <div class="blog_30 hidden_phone"></div>
            <div class="row_fluid">
                <h2 class="post_details_title" title="{{title}}">{{title}}</h2>
                <div class="post_details_desc">{{{html_body}}}</div>
            </div>
            <div class="row_fluid">
                <div class="details_share_icons_mobile">
                    <a href="https://www.facebook.com/sharer.php?u=https://www.halifaxshoppingcentre.com/our_style/{{slug}}" target="_blank">
                        <img class="details_icon" src="//codecloud.cdn.speedyrails.net/sites/5808c7e76e6f6414b30c0000/image/jpeg/1490794350000/fb.jpg" alt="Facebook Logo">
                    </a>
                    <a href="https://twitter.com/home?status={{twitter_title}} https://www.halifaxshoppingcentre.com/our_style/{{slug}}" target="_blank">
                        <img class="details_icon" src="//codecloud.cdn.speedyrails.net/sites/5808c7e76e6f6414b30c0000/image/jpeg/1490794359000/tw.jpg" alt="Twitter Logo">
                    </a>
                </div>
            </div>
            <div class="row_fluid">
                <div class="post_detail_divider">
                    <div class="col-md-6">
                        <a href="{{prev_post}}" class="red pull-left" style="{{prev_show}}"><img src="//codecloud.cdn.speedyrails.net/sites/5808c7e76e6f6414b30c0000/image/png/1490621978000/left.png" class="post_details_arrow" alt=""><span class="post_details_link">Previous Post</span></a>
                    </div>
                    <div class="col-md-6">
                        <a href="{{next_post}}" class="red pull-right" style="{{next_show}}"><span class="post_details_link">Next Post</span><img src="//codecloud.cdn.speedyrails.net/sites/5808c7e76e6f6414b30c0000/image/png/1490620798000/right.png" class="post_details_arrow" alt="Right Arrow"></a>
                    </div>
                </div>
            </div>
        </script>
    </div>
</div>

<script id="gallery_template" type="x-tmpl-mustache/text">
    <div class="col-md-6">
        <div class="gallery_content mobile_padding">
            <div class="gallery_image">
                <a class="open_details_modal" data-modal-id="{{id}}">
                    <img src="{{gallery_image}}">
                </a>
            </div>
            <div class="gallery_caption">{{caption}}</div>
            <div class="gallery_description">{{{description}}}</div>
        </div>
    </div>
</script>

<script>
    $(document).ready(function(e){
        init(e);
        loadMallDataCached(renderPageData);
    });
    
    function renderPageData(){
        var pathArray = window.location.pathname.split( '/' );
        var slug = pathArray[pathArray.length-1];
        var post = getPublishedPostDetailsBySlug(slug);
        console.log(post)
        var blog_posts = getBlogDataBySlug('halifaxcentre-our-style').posts.reverse();

        renderPostDetails("#post_details_container", "#post_details_template", post, blog_posts);
        
        var galleries = $('gallery');
        var gallery = [];
        $.each(galleries, function(key, val) {
            var container = $(val);
            var gallery_slug = $(val).attr('source');
            gallery = getFashionBySlug(gallery_slug).fashion_images;
            renderGallery(container, "#gallery_template", gallery);
        });
        var id_list = [];
        $.each(gallery, function(key, val) {
            var id = val.id;
            id_list.push(val.id);
        });
    
        var window_width = $( window ).width();
        if (window_width < 769) {
            $('a').removeClass('open_details_modal');
        }
        $('.custom-modal-backdrop').click(function(){
            $('body').removeClass('gallery_no_scroll');
            $('.custom_modal').fadeOut();
            $('.custom-modal-backdrop').fadeOut();
        });
        
        $('.modal_close').click(function(){
            $('body').removeClass('gallery_no_scroll');
            $('.custom_modal').fadeOut();
            $('.custom-modal-backdrop').fadeOut();
        });
        
        var post_title = $('.post_details_title').attr('title');

        $('.open_details_modal').click(function(e){
            e.preventDefault();
            $('body').addClass('gallery_no_scroll');
            
            var modal_id = $(this).attr('data-modal-id');
            $.each(gallery, function(fi_i, fi_val){
                if (fi_val.id == modal_id){
                    fi = fi_val;
                }
            });
            var current_id = fi.id;
            var index = id_list.indexOf(current_id);
            if(index >= 0 && index < id_list.length){
               var next = id_list[index + 1];
               $('.next_arrow').show();
               if(next === undefined) {
                   $('.next_arrow').hide();
               }
            }
            if(index >= 0 && index < id_list.length){
               var prev = id_list[index - 1];
               $('.prev_arrow').show();
               if(prev === undefined) {
                   $('.prev_arrow').hide();
               }
            }
            $('.custom-modal-backdrop').fadeIn();
            $('.custom_modal').fadeIn();
            $('.modal_img').attr('src', fi.gallery_image);
            $('#modal_name').html(fi.caption);
            $('#modal_desc').html(fi.description);
            $('#share_fb').attr('href', "https://www.facebook.com/sharer.php?u=https://www.halifaxshoppingcentre.com/our_style/"+ slug);
            $('#share_twitter').attr('href', "https://twitter.com/home?status=" + post_title + " via @shopHSC https://www.halifaxshoppingcentre.com/our_style/" + slug);
            $('#prev').attr('data-modal-id', prev);
            $('#next').attr('data-modal-id', next);
        });

        show_content();
    }
</script>